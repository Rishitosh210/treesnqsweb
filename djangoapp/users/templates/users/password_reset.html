{% extends "projects/base_small.html" %}
{% load crispy_forms_tags %}
{% block content %}
<script>
  function requestResetPassword() {
    var email = $("input[name=email]").val();
    if (email.trim().length > 0) {
      var formData = $("form").serialize();
      $.post(
        window.location.href,
        formData,
        function (data) {       
          $('#popup').css("visibility", "visible");   
          $('#popup').html(
            '<div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">'
            + '<a href="javascript:backToPrevious()" style="text-decoration: none;">'
            + '<div style="display: flex; flex-direction: column; justify-content: center; align-items: center; width: 80vw; height: 20vh;'
            + 'border-radius: 0.5rem; background-color: #000b; color: #888;">An email has been sent with instructions to reset your password.</div>'
            + '</a>'
            + '</div>');

          setTimeout(function () {
            $('#popup').fadeOut(2000, function () {
              $('#popup').css("visibility", "hidden");
              $('#popup').html("");
              backToPrevious();
            });
          }, 2000);
        }
      );
    } else {
      $("form").submit();
    }
  }

  function backToPrevious() {
    window.history.back();
  }
</script>
<!--Main layout-->
<main>
  <div class="container pt-5">
    <!--Section: Projects v.3-->
    <section class="text-left mb-4">
      <div class="row row fadeIn pt-5">
        <div class="col-6 offset-3">
          <form method="POST" onsubmit="return false">
            {% csrf_token %}
            <fieldset class="form-group">
              <legend class="border-bottom mb-4">Reset Password</legend>
              {{ form|crispy }}
            </fieldset>
            <div class="form-group">
              <button class="btn btn-outline-info" type="submit" onclick="requestResetPassword()">Request Password Reset</button>
            </div>
          </form>
        </div>
      </div>
    </section>
  </div>
</main>
{% endblock content %}